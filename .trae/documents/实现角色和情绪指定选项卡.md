# 实现角色和情绪指定选项卡代码

## 1. 创建代码区域和相关方法

* 创建 `#region 角色和情绪指定UI操作` 代码区域

* 创建相关的UI事件处理、UI操作和业务操作子区域

* 实现 `init角色和情绪指定Ui()` 初始化方法

* 实现 `refresh角色和情绪指定Ui()` 刷新方法

* 实现 `clear角色和情绪指定Ui()` 清理方法

## 2. 创建数据结构

* 创建 `RoleTextItem` 类，包含两个属性：`Role`（角色）和 `Text`（文本）

* 用于绑定到 `dgv_角色和情绪指定` 表格

## 3. 表格设置

* **代码设置**：

  * 角色列：最小宽度100，启用按最大单元格自动调节

  * 文本列：最小宽度500，允许折行显示，不自动调节宽度

  * 行设置：最小高度与 `dgv_TTL方案_朗读者参数配置` 相同，启用行高自动调节

  * 字体设置：参考 `dgv_TTL方案_朗读者参数配置` 的字体和字号设置

  * 行为设置：停用增加和删除功能，启用编辑功能，角色列使用下拉列表框，文本列使用文本框

## 4. 数据流转

* 实现从其他选项卡通过 "发送到下一步" 按钮获取数据的功能

* 按换行分割文本，填充到表格中，保留空行

## 5. 按钮功能

* **清理文本按钮**：

  * 弹出确认提示框

  * 清理表格中的所有内容

* **发送到下一步按钮**：

  * 将角色文本添加到每一行的开头，格式 "\[角色]文本"

  * 组成最终文本并传递到下一个选项卡

## 6. 右键快捷菜单

* 创建右键快捷菜单，用于对多行指定相同的角色

* 实现批量设置角色的功能

## 7. 保存和加载

* 实现表格内容的保存功能

* 实现表格内容的加载功能

* 参考其他选项卡的保存和加载实现方式

## 8. 事件处理

* 实现表格的各种事件处理方法

* 实现按钮的点击事件处理方法

* 实现右键菜单的点击事件处理方法

